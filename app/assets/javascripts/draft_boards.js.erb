$(function() {
	// set height of draft row padding
	top_row_height = $(".draft-edit-top-row-container").height();
	$(".draft-edit-top-row-container").next().css('padding-top', top_row_height);
	
	// check if add new draft button has .fields siblings
	if ($("#add-drink-button").prev().hasClass("fields")) {
		field_width = $(".fields").width();
		$(".draft-edit-top-row-container").width(field_width);
	} else {
		$("#add-drink-button").css('margin-top', top_row_height);
		field_width = $(".draft-board-container").width() - 30;
		$(".draft-edit-top-row-container").width(field_width);
	}
	// count number of drink sizes in each row & adjust drink size count
	$(document).on('click', '.formButton-add-details.add_nested_fields', function () {
	    var siblings = 0
	    $(this).siblings().each(function() {
	    	if ($(this).css('display') != 'none') {
    			siblings++;
    			if(siblings == 1) {
    				$(this).children(".draft-details-row").children(".size-option-text-holder").children(".size-option-text").html("1st size option");
    			}
    			if(siblings == 2) {
    				$(this).children(".draft-details-row").children(".size-option-text-holder").children(".size-option-text").html("2nd size option");
    			}
    			if(siblings == 3) {
    				$(this).children(".draft-details-row").children(".size-option-text-holder").children(".size-option-text").html("3rd size option");
    			}
    			if(siblings == 4) {
    				$(this).children(".draft-details-row").children(".size-option-text-holder").children(".size-option-text").html("4th size option");
    			}
			}
	    });
	    if (siblings >= 4) {
	    	$('.formButton-add-details.add_nested_fields').hide();
	    } 
	});
	$(document).on('click', '.remove_nested_fields', function () {
	    var siblings = 0
	    $(this).parent().parent().parent().siblings().each(function(value) {
	    	if ($(this).css('display') != 'none') {
    			siblings++;
    			if(siblings == 1) {
    				$(this).children(".draft-details-row").children(".size-option-text-holder").children(".size-option-text").html("1st size option");
    			}
    			if(siblings == 2) {
    				$(this).children(".draft-details-row").children(".size-option-text-holder").children(".size-option-text").html("2nd size option");
    			}
    			if(siblings == 3) {
    				$(this).children(".draft-details-row").children(".size-option-text-holder").children(".size-option-text").html("3rd size option");
    			}
    			if(siblings == 4) {
    				$(this).children(".draft-details-row").children(".size-option-text-holder").children(".size-option-text").html("4th size option");
    			}
			}
	    });
	    if (siblings <= 4) {
	    	$(this).parent().parent().parent().siblings('.formButton-add-details.add_nested_fields').show();
	    } 
	});
	// count number of drinks loaded
	$(document).on('click', '.formButton-add-draft.add_nested_fields', function () {
	    var siblings = 0
	    $(this).siblings().each(function() {
		    if ($(this).hasClass('fields')) {
		    	if ($(this).css('display') != 'none') {
	    			siblings++;
	    			$(this).children(".new-draft-row").children(".tap-number-holder").children("input").val(siblings);
				}
			}
	    });
	});
	// get unique id of search box when it comes into focus; then send it to the controller to store in session variable
	$(document).one('focus', '.form-control.typeahead.retailer-search.tt-input', function (e) {
		var counter;
		counter = 1;
		var inputID;
		if (counter == 1) {
			var inputID = $(e.target).attr('id');
			alert(inputID);
			counter++;
			$.ajax({
		    	url : "/draft_boards/edit",
		        data : {inputID: inputID},
		        type : "get"
			    
			});
		}
				
	});	
	// bind autonumeric javascript each time a new drink details row is added
	$(document).on('nested:fieldAdded', function(event){
		$(document).trigger('refresh_autonumeric');
	});

});