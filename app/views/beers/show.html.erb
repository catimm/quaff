<%= render 'layouts/header' %> 
<div class="container">
	<div class="row">
		<div class="col-sm-1 col-xs-0"></div>
		<div class="col-sm-10 col-xs-12 beer-info-tile">
			<div class="row">
				<div class="col-sm-8 col-xs-12">
					<div class="row no-margin">
						<div class="col-xs-4 no-padding">
							<div class="brewery-image-holder-full-page">	
								<% if !@beer.brewery.image.nil? %>
									<div class="brewery-image-holder-full text-center">
										<img class="img-responsive center-block" alt="Responsive image" src="<%= @beer.brewery.image %>">
									</div>	
								<% else %>
									<div class="brewery-image-holder-empty-full-page text-center">
										<h1><i class="fa fa-beer"></i></h1>
									</div>
								<% end %>
							</div>
						</div>
						<div class="col-xs-7 cloud-holder-full-page" id="cloud-holder-full-page"></div>
					</div>
					<div class="row no-margin">
						<div class="col-xs-12">
							<% if @beer.collab == true %>
								<% @collab_brewery_name = Beer.collab_brewery_name(@beer.id) %>
								<h5 class="tile-header beer-tile-header-full-page"><%= @collab_brewery_name %> <%= ("<span class=combined-drink-text>"+@beer.beer_name+"</span>").html_safe %></h5>
							<% else %>
								<h5 class="tile-header beer-tile-header-full-page"><%= @beer.brewery.short_brewery_name %> <%= ("<span class=combined-drink-text>"+@beer.beer_name+"</span>").html_safe %></h5>
							<% end %>
						</div>
						<div class="col-xs-12">
							<% if !@beer.beer_type_id.nil? %>
								<h5 class="tile-subheader beer-info no-overflow"><%= @beer.beer_type.beer_type_name %></h5>
							<% else %>
								<h5 class="tile-subheader beer-info">Style unknown</h5>
							<% end %>
						</div>
						<div class="col-sm-3 col-xs-6 no-padding-right">
							<% if !@beer.beer_abv.nil? %>
								<h6 class="tile-subheader beer-info"><%= @beer.beer_abv %>% ABV</h6>
							<% else %>
								<h6 class="tile-subheader beer-info">ABV N/A</h6>
							<% end %>
						</div>
						<% if !@beer.beer_ibu.nil? %>
							<div class="col-sm-3 col-xs-6 no-padding-left text-center ibu-div">
								<h6 class="tile-subheader beer-info"><%= @beer.beer_ibu %> IBUs</h6>
							</div>
						<% else %>
							<div class="col-xs-6"></div>
						<% end %>
					</div>
					<% if !@beer.brewer_description.nil? %>
					<div class="row no-margin">
						<div class="col-xs-12">
							<h5 class="small-brewer-description" id="brewer-description"><%= @beer.brewer_description %></h5>
							<%= link_to "+ more", "#", class: "show more-brewer-description", :id => "more-brewer-description" %>
							<%= link_to "- less", "#", class: "hidden less-brewer-description", :id => "less-brewer-description" %>
						</div>
					</div>
					<% end %>
					<div class="row no-margin our-best-guess">
						<div class="col-sm-6 col-xs-12">
							<% if @beer.user_rating %>
								<% if ((((@beer.user_rating) * 2).round)/2.0) == ((((@beer.best_guess) * 2).round)/2.0) %>
									<p>Our <span class="best-guess">best guess</span> was <span class="best-guess"><%= ((((@beer.best_guess) * 2).round)/2.0) %></span> and you rated it:</p>
									<h1 class="user-rating"><%= @beer.user_rating.round(2) %></h1>
								<% else %>
									<p>Our <span class="best-guess">best guess</span> was <span class="best-guess"><%= ((((@beer.best_guess) * 2).round)/2.0) %></span> but you rated it:</p>
									<h1 class="user-rating"><%= @beer.user_rating.round(2) %></h1>
								<% end %>
							<% else %>
								<p>Our <span class="best-guess">best guess</span> for you:</p>
								<% if @beer.best_guess > 10 %>
									<% @beer.best_guess == 10 %>
								<% end %>
								<% if @beer.best_guess % 1 == 0 %>
									<h1 class="best-guess"><%= ((((@beer.best_guess) * 2).round)/2.0) %></h1>
								<% else %>
									<h1 class="best-guess"><%= ((((@beer.best_guess) * 2).round)/2.0) %></h1>
								<% end %>
							<% end %>
						</div>
						<div class="col-sm-6 col-xs-12 why-statement full-page">
							<p>Why, you ask?</p>
							<% if @beer.recommendation_rationale == "style" %>
								<% if  @beer.is_hybrid == "yes" %>
									<%= render 'locations/hybrid_rating_rationale', beer: @beer %>
								<% else %>
									<%= render 'locations/nonhybrid_rating_rationale', beer: @beer %>
								<% end %>
							<% else %>
								<%= render 'locations/type_rating_rationale', beer: @beer %>
							<% end %>
						</div>
					</div>
				</div>
				<div class="col-sm-4 col-xs-12">
					<%= link_to new_user_rating_path(@user_id, @beer.id), class: 'btn btn-default btn-success formButton' do %>
						<i class="fa fa-tasks"> rate drink</i>
					<% end %>
					<% if !@current_beer_locations.blank? %>
						<h4 class="beer-location-status">This beer is currently at:</h4>
						<ul class="locations-list">
						<% @current_beer_locations.each do |location| %>
							<% @this_location = Location.where(id: location)[0] %>
							<li>
								<div class="row img-responsive location-logo-image-small" alt="Responsive image" style="background-image: url(<%= @this_location.logo_small %>)">
									<p class="location-name-by-image"><%= @this_location.short_name %></p>
								</div>
							</li>
						<% end %>
						</ul>
					<% else %>
						<% if !@recent_beer_locations.blank? %>
							<h4 class="beer-location-status">This beer was last seen at:</h4>
							<ul class="locations-list">
							<% @recent_beer_locations.each_with_index do |location, i| %>
								<% if i < 3 %>
									<% @this_location = Location.where(id: location.location_id)[0] %>
									<li>
										<div class="row img-responsive location-logo-image-small" alt="Responsive image" style="background-image: url(<%= @this_location.logo_small %>)">
											<p class="location-name-by-image"><%= @this_location.short_name %> on <%= (location.removed_at).strftime("%b %e, %Y") %></p>
										</div>
										
									</li>
								<% end %>
							<% end %>
							</ul>
						<% else %>
							<h4 class="beer-location-status not-seen-message">This beer hasn't been on tap in Seattle since before April 2015...</h4>
						<% end %>
					<% end %>
					<% if !@user_beer_tracking.empty? %>
						<h4 class="beer-tracking-status">You're currently tracking this beer at:</h4>
							<ul class="locations-list">
							<% @tracking_locations.each_with_index do |location, i| %>
								<% if location.location_id != 0 %>
									<% @this_location = Location.where(id: location.location_id)[0] %>
										<li>
											<div class="row img-responsive location-logo-image-small" alt="Responsive image" style="background-image: url(<%= @this_location.logo_small %>)">
												<p class="location-name-by-image"><%= @this_location.short_name %></p>
											</div>
										</li>
								<% else %>
									<li>
										<h4 class="beer-location-status">All Seattle locations!</h4>
									</li>
								<% end %>	
							<% end %>
						<%= link_to new_user_tracking_path(current_user.id, @beer.id), class: 'btn btn-default btn-primary formButton-track-beer' do %>
							<i class="fa fa-pencil"> edit tracking options</i>
						<% end %>
						<h6 class="text-center or-option">- or -</h6>
						<%= link_to edit_user_tracking_path(current_user.id, @beer.id), class: 'btn btn-danger btn-primary formButton-track-beer-stop' do %>
							<i class="fa fa-minus"> stop tracking beer</i>
						<% end %>
					<% else %>
						<%= link_to new_user_tracking_path(current_user.id, @beer.id), class: 'btn btn-default btn-primary formButton-track-beer' do %>
							<i class="fa fa-plus"> track beer</i>
						<% end %>
					<% end %>
				</div>
			</div>
			<% if !@user_rating_for_this_beer.blank? %>
			<hr class="visible-sm visible-md visible-lg" />
			<div class="row no-margin">
				<div class="col-xs-12">
					<h5 class="tile-header user-rating-section">Your thoughts</h5>
				</div>
				<div class="col-sm-6 col-xs-12">
					<% @user_rating_for_this_beer.each_with_index do |rating, index| %>
					<div class="row no-margin">
						<div class="col-xs-12">
							<% if !rating.drank_at.nil? %>
								<h6 class="beer-info no-overflow"><%= rating.rated_on.strftime("%b %e, %Y") %> @ <%= rating.drank_at %></h6>
							<% else %>
								<h6 class="beer-info no-overflow"><%= rating.rated_on.strftime("%b %e, %Y") %></h6>
							<% end %>
							<div class="row">
								<div class="col-xs-4 past-user-rating">
									<p>rated:</p>
									<h1 class="user-rating"><%= rating.user_beer_rating %></h1>
								</div>
								<div class="col-xs-8 past-user-descriptors">
									<p>descriptors:</p>
									<% if !rating.current_descriptors.nil? %>
										<% @descriptor_list_initial = rating.current_descriptors.split(',') %>
										<% @descriptor_list_final = @descriptor_list_initial.to_sentence %>
										<h5 class="user-rating"><%= @descriptor_list_final %></h5>
									<% else %>
										<h6 class="user-rating">no descriptors provided</h6>
									<% end %>
								</div>
							</div>
							<% if !rating.comment.blank? %>
							<div class="row">
								<div class="col-xs-12 past-user-comment">
									<p>comment:</p>
									<h5 class="tile-subheader beer-info">"<%= rating.comment %>"</h5>
								</div>
							</div>
							<% end %>
						</div>
					</div>
						<% if @number_of_ratings != index +1 %>
							<hr/>
						<% end %>
					<% end %>
				</div>
			</div>
			<% end %>
		</div>
	</div>
</div>
<%= render 'layouts/footer' %>